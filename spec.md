# 2026 FIFAワールドカップ グループステージ突破予想確率シミュレーション 仕様書

## 1. 概要

本アプリケーションは、2026年FIFAワールドカップにおける特定のチームのグループステージ（GS）突破確率を、ユーザーが予想した各試合の勝敗確率に基づいてシミュレーション・算出するWebツールである。

## 2. システム構成

* **プラットフォーム:** Webブラウザ（PC / スマートフォン）
* **技術スタック:**
* HTML5
* CSS3 (レスポンシブデザイン対応)
* JavaScript (Vanilla JS, ES6+)


* **依存関係:** 外部ライブラリ不使用（ゼロ依存）
* **データ管理:** ローカルJSONファイル (`teams.json`) および クライアントサイド処理のみ

## 3. ファイル構成

```text
/
├── index.html          # メイン画面（シミュレーター）
├── select.html         # チーム選択画面
├── teams.json          # チーム・グループデータ定義
├── css/
│   └── style.css       # 全体スタイルシート
├── js/
│   └── script.js       # 計算ロジック、UI制御、多言語対応
└── img/
    ├── JP.png          # 各国国旗画像（ISO 3166-1 alpha-2コード等）
    └── ...

```

## 4. 機能要件

### 4.1. チーム選択機能

* ユーザーは全参加国（グループA〜L）の中から、計算対象とするチームを選択できる。
* 選択画面 (`select.html`) ではグループごとにチームを表示。
* 選択したチーム情報はURLパラメータ (`?team=XX`) としてメイン画面に引き継がれる。
* デフォルトチームは日本 (JP)。

### 4.2. 確率入力・計算機能

* 対象チームを除く、同グループの3チームとの対戦ごとの「勝利」「引き分け」「敗北」の確率を入力可能（0〜100%）。
* **入力制限:**
* 0未満は0、100超過は100に自動補正。
* 3項目の合計が100%でない場合、エラーメッセージを表示。


* **計算ロジック:**
* 全3試合の勝敗パターン（通り）の発生確率を計算。
* 各パターンの勝ち点（勝3, 分1, 負0）を算出。
* 勝ち点ごとに定義された「突破期待値（係数）」を掛け合わせ、最終的な突破確率を算出。



### 4.3. 結果表示機能

* **総合確率:** GS突破予想確率をパーセント表示。
* **内訳テキスト:**
* 「勝ち点4以上（突破確定圏）」
* 「勝ち点3（得失点差勝負）」
* 「勝ち点2以下（敗退濃厚）」
の3パターンに分類して確率を表示。


* **詳細テーブル:** 勝ち点ごとの発生確率と、判定ステータス（「突破」「ほぼ確実」「可能性あり」「奇跡待ち」「敗退決定」）を表示。

### 4.4. シェア機能 (URL生成)

* 現在の入力値（勝率・引分率）をJSON配列化し、Base64エンコードしてURLパラメータ (`?s=...`) に埋め込む。
* 「シェア用URLをコピー」ボタン押下時、クリップボードに現在の状態を保持したURLをコピーする。
* **難読化:** URL上のパラメータはBase64化され、一見して数値が分からないように配慮。
* **フォールバック:** `navigator.clipboard` が使用できない環境（http等）では、隠しテキストエリアを用いたコピー処理へ自動切り替え。

### 4.5. 多言語対応 (I18n)

* 日本語 (ja) と 英語 (en) の切り替えが可能。
* 言語設定はURLパラメータ (`?lang=en`) で管理・維持される。
* チーム名、UIラベル、結果メッセージ、判定ステータスすべてが翻訳対象。

## 5. データ構造仕様

### 5.1. `teams.json`

グループおよびチーム情報を定義する。

```json
[
  {
    "id": "F",
    "name": { "ja": "グループ F", "en": "Group F" },
    "teams": [
      { "code": "NL", "name": { "ja": "オランダ", "en": "Netherlands" } },
      { "code": "JP", "name": { "ja": "日本", "en": "Japan" } },
      ...
    ]
  },
  ...
]

```

### 5.2. 定数: 突破期待値 (`QUALIFY_RATES`)

過去大会やシミュレーションに基づく、勝ち点ごとのGS突破確率の定数。
| 勝ち点 | 突破率 (係数) | 判定ステータス |
| :--- | :--- | :--- |
| 9, 7, 6, 5 | 1.000 (100%) | 突破 (Safe) |
| 4 | 0.993 (99.3%) | ほぼ確実 (Likely) |
| 3 | 0.473 (47.3%) | 可能性あり (Border) |
| 2 | 0.025 (2.5%) | 奇跡待ち (Miracle) |
| 1, 0 | 0.000 (0%) | 敗退決定 (Out) |

## 6. UI/UX デザイン仕様

### 6.1. ヘッダー

* **タイトル:** 画面中央に配置。
* **設定バー:** 画面右上に配置（スマホ時は上部右端）。言語切り替えプルダウンを含む。

### 6.2. メインエリア

* **対象チーム表示:** 国旗（大）とチーム名を表示。横に「変更」ボタンを配置。
* **入力テーブル:** 国旗、チーム名、入力フィールド（勝/分/負）を配置。
* **結果エリア:**
* 計算結果は入力と同時にリアルタイム反映（`oninput` イベント）。
* 判定ステータスに応じて色分け（緑、黄、赤、濃赤）。



### 6.3. フッター

* GitHubリポジトリへのリンクとアイコンを表示。

### 6.4. レスポンシブ対応

* **スマートフォン表示 (幅600px以下):**
* ヘッダーのレイアウトを縦並びに調整。
* 入力フィールドの幅を縮小し、画面内に収める。
* 設定バーの位置調整。



## 7. URLパラメータ仕様

| パラメータ | 説明 | 例 |
| --- | --- | --- |
| `team` | 対象チームの国コード (teams.jsonのcode準拠) | `JP`, `BR`, `UEFA-A` |
| `lang` | 表示言語 (`ja` または `en`) | `en` |
| `s` | 入力状態データ (Base64エンコードされた数値配列) | `W30sMzAsMzAsNTAsMzAsNDBd` |

---
Geminiで生成
**作成日:** 2026/01/05
**バージョン:** 1.0